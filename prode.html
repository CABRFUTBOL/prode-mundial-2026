<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Prode Mundial 2026</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h1, h2, h3 { margin-bottom: 10px; }
    div { margin-bottom: 5px; }
    input { width: 50px; margin: 0 5px; }
    button { margin: 10px 0; padding: 5px 10px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Prode Mundial 2026</h1>

  <!-- Inputs para pronósticos -->
  <div id="pronosticos"></div>

  <!-- Botón para guardar pronósticos -->
  <button onclick="guardarPronosticos()">Guardar pronósticos</button>
  <div id="mensaje"></div>

  <!-- Div donde se generará la tabla y el botón -->
  <div id="tabla"></div>

  <script>
    // ----- Datos iniciales -----
    let partidos = [
      { local: "Argentina", visitante: "Brasil" },
      { local: "México", visitante: "España" },
      { local: "Francia", visitante: "Alemania" },
      { local: "Inglaterra", visitante: "Italia" },
      { local: "Portugal", visitante: "Holanda" }
    ];

    let jugadores = [
      { nombre: "Juan", pronosticos: [] },
      { nombre: "María", pronosticos: [] },
      { nombre: "Carlos", pronosticos: [] },
      { nombre: "Lucía", pronosticos: [] },
      { nombre: "Sofía", pronosticos: [] }
    ];

    // ----- Resultados reales -----
    let resultados = [
      { local: "Argentina", visitante: "Brasil", golesLocal: 2, golesVisitante: 1 },
      { local: "México", visitante: "España", golesLocal: 1, golesVisitante: 1 },
      { local: "Francia", visitante: "Alemania", golesLocal: 0, golesVisitante: 3 },
      { local: "Inglaterra", visitante: "Italia", golesLocal: 2, golesVisitante: 2 },
      { local: "Portugal", visitante: "Holanda", golesLocal: 1, golesVisitante: 0 }
    ];

    // ----- Generar formulario dinámico -----
    function generarFormulario() {
      let div = document.getElementById("pronosticos");
      div.innerHTML = "";
      jugadores.forEach((jugador, j) => {
        div.innerHTML += `<h3>${jugador.nombre}</h3>`;
        partidos.forEach((p, i) => {
          div.innerHTML += `
            <div>
              ${p.local} vs ${p.visitante}:
              <input type="number" id="g${j}-${i}-local" min="0" placeholder="Goles ${p.local}">
              <input type="number" id="g${j}-${i}-visitante" min="0" placeholder="Goles ${p.visitante}">
            </div>
          `;
        });
      });

      // ----- Generar botón de tabla automáticamente -----
      let tablaDiv = document.getElementById("tabla");
      // Si el botón ya existe, no lo volvemos a crear
      if (!document.getElementById("btnTabla")) {
        let botonTabla = document.createElement("button");
        botonTabla.id = "btnTabla";
        botonTabla.innerText = "Ver tabla de posiciones";
        botonTabla.onclick = mostrarTabla;
        tablaDiv.parentNode.insertBefore(botonTabla, tablaDiv);
      }
    }

    generarFormulario();

    // ----- Guardar pronósticos -----
    function guardarPronosticos() {
      jugadores.forEach((jugador, j) => {
        jugador.pronosticos = [];
        partidos.forEach((p, i) => {
          let golesLocal = parseInt(document.getElementById(`g${j}-${i}-local`).value) || 0;
          let golesVisitante = parseInt(document.getElementById(`g${j}-${i}-visitante`).value) || 0;
          jugador.pronosticos.push({ golesLocal, golesVisitante, puntaje: 0 });
        });
      });
      document.getElementById("mensaje").innerText = "Pronósticos guardados correctamente!";
      console.log(jugadores);
    }

    // ----- Calcular puntajes -----
    function calcularPuntajes() {
      jugadores.forEach(jugador => {
        jugador.pronosticos.forEach((pronostico, i) => {
          let real = resultados[i];
          if(pronostico.golesLocal === real.golesLocal && pronostico.golesVisitante === real.golesVisitante){
            pronostico.puntaje = 2;
          } else if((pronostico.golesLocal - pronostico.golesVisitante) === (real.golesLocal - real.golesVisitante)){
            pronostico.puntaje = 1;
          } else {
            pronostico.puntaje = 0;
          }
        });
        jugador.puntajeTotal = jugador.pronosticos.reduce((sum, p) => sum + p.puntaje, 0);
      });
    }

    // ----- Mostrar tabla de posiciones -----
    function mostrarTabla() {
      calcularPuntajes();
      let div = document.getElementById("tabla");
      div.innerHTML = "<h2>Tabla de posiciones</h2>";
      let ordenados = [...jugadores].sort((a,b) => b.puntajeTotal - a.puntajeTotal);
      ordenados.forEach(j => {
        div.innerHTML += `<div>${j.nombre}: ${j.puntajeTotal} pts</div>`;
      });
    }
  </script>
</body>
</html>
